<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <f:view contentType="text/html"></f:view>
    <ui:composition template="/pages/templates/default.xhtml">
        <ui:define name="corpo">
            <h:form id="orcamentoCurso">
                <div id="centro"> <br></br>
                    <img  src="#{orcamentoCursoMB.srcLogo(orcamentoCursoMB.filtrarEscolaMB.fornecedorProdutosBean.fornecedorCidade.fornecedor)}" /> 
                    <h:panelGrid columns="1" style="width: 100%;margin-left:12%;margin-top: -8%">
                        <h:outputText value="#{orcamentoCursoMB.filtrarEscolaMB.fornecedorProdutosBean.fornecedorCidade.produtos.descricao}" style="font-weight:bold;font-size: 20px;color: #fff" class="espacocobranca29"/>
                        <p:commandLink value="#{orcamentoCursoMB.filtrarEscolaMB.fornecedorProdutosBean.fornecedorCidade.fornecedor.nome}" title="Descrição" style="font-weight:bold;font-size: 19px;color: #fff" class="espacocobranca29" oncomplete="PF('descricaoEscola').show()"/>
                        <p:commandLink value="#{orcamentoCursoMB.filtrarEscolaMB.fornecedorProdutosBean.fornecedorCidade.cidade.nome}" title="Mapa" style="font-weight:bold;font-size: 13px;color: #fff" class="espacocobranca29"  oncomplete="PF('mapaEscola').show()"/>
                    </h:panelGrid>
                    <p:commandButton id="bntvoltar" class="espacocobranca3botao" style="font-size:12px;margin-left:91%" value="Voltar"  action="#{orcamentoCursoMB.voltar()}" icon="ui-icon-arrowreturnthick-1-w" />
                    <br></br>
                    <h:outputText value="Curso" style="font-weight:bold;font-size: 17px;color: #fff" class="espacocobranca29"/>
                    <p:dataScroller id="tabelaprodutoObrigatorio" value="#{orcamentoCursoMB.filtrarEscolaMB.fornecedorProdutosBean.listaObrigaroerios}" var="obrigatorio" chunkSize="10" style="background:#fff" >
                        <p:outputPanel style="text-align: right;width:100%">
                            <h:panelGrid columns="3" style="width:100%;background:#fff" >
                                <p:outputPanel style="width:50%;" >
                                    <h:panelGrid columns="2" >
                                        <p:selectBooleanCheckbox value="#{orcamentoCursoMB.obrigatorioSelecionado}" disabled="true"></p:selectBooleanCheckbox>
                                        <h:outputText value="#{obrigatorio.valorcoprodutos.coprodutos.produtosorcamento.descricao}" style="font-weight:bold;font-size: 15px;"/>
                                    </h:panelGrid>
                                </p:outputPanel>
                            </h:panelGrid>
                        </p:outputPanel>
                        <p:outputPanel style="text-align: right;width:100%;background:#fff;margin-top: -3%" >
                            <h:panelGrid columns="1" cellpadding="5" style="text-align: right;width:100%">
                                <p:commandLink id="valorPromocional" value="#{orcamentoCursoMB.retornarValorString(obrigatorio.valorOrigianl, orcamentoCursoMB.filtrarEscolaMB.fornecedorProdutosBean.cambio.moedas.sigla)}"  style="font-weight:bold;font-size:14px;text-align: right;"/>
                                <p:overlayPanel id="painelDescricao2" for="valorPromocional" hideEffect="fade" style="width:30%;background:#CCCCCC" >
                                    <h:outputText value="Valor Original:" style="font-weight:bold"/>
                                    <h:outputText value="#{orcamentoCursoMB.filtrarEscolaMB.fornecedorProdutosBean.cambio.moedas.sigla}" style="font-weight:bold" class="espacocobranca29"/>
                                    <h:outputText value="#{obrigatorio.valorOrigianl}" style="font-weight:bold">
                                        <f:convertNumber pattern="##,###,###,###.##" minFractionDigits="2" />
                                    </h:outputText>
                                    <br></br><br></br>
                                    <h:outputText value="R$ " style="font-size:9px;" class="espacocobranca29"/>
                                    <h:outputText value="#{obrigatorio.valorOriginalRS}" style="font-size:9px;"/>
                                </p:overlayPanel>
                                <br></br>
                            </h:panelGrid>
                        </p:outputPanel>
                    </p:dataScroller>
                    <br></br> <br></br>
                    <h:outputText value="Opcional" style="font-weight:bold;font-size: 17px;color: #fff" class="espacocobranca29"/>
                    <p:dataScroller id="tabelaprodutoOpcional" value="#{orcamentoCursoMB.filtrarEscolaMB.fornecedorProdutosBean.listaOpcionais}" var="opcional" chunkSize="10" style="background:#fff" >
                        <p:outputPanel style="text-align: right;width:100%">
                            <h:panelGrid columns="3" style="width:100%;background:#fff" >
                                <p:outputPanel  >
                                    <h:panelGrid columns="2" >
                                        <p:selectBooleanCheckbox value="#{opcional.selecionadoOpcional}">
                                            <p:ajax listener="#{orcamentoCursoMB.calcularTotais()}" update="orcamentoCurso:tabelatotal"/>
                                        </p:selectBooleanCheckbox>
                                        <h:outputText value="#{opcional.valorcoprodutos.coprodutos.produtosorcamento.descricao}"   style="font-weight:bold;font-size: 15px;"/>
                                    </h:panelGrid>
                                </p:outputPanel>
                            </h:panelGrid>
                        </p:outputPanel>
                        <p:outputPanel style="text-align: right;width:100%;background:#fff;margin-top: -3%" >
                            <h:panelGrid id="valoresOpcional" columns="1" cellpadding="5" style="text-align: right;width:100%">
                                <p:commandLink id="valorPromocional" value="#{orcamentoCursoMB.retornarValorString(opcional.valorOrigianl, orcamentoCursoMB.filtrarEscolaMB.fornecedorProdutosBean.cambio.moedas.sigla)}"  style="font-weight:bold;font-size:14px;text-align: right;"/>
                                <p:overlayPanel id="painelDescricaoPromocional" for="valorPromocional" hideEffect="fade" style="width:30%;background:#CCCCCC" >
                                    <h:outputText value="Valor Original:" style="font-weight:bold"/>
                                    <h:outputText value="#{orcamentoCursoMB.filtrarEscolaMB.fornecedorProdutosBean.cambio.moedas.sigla}" style="font-weight:bold" class="espacocobranca29"/>
                                    <h:outputText value="#{opcional.valorOrigianl}" style="font-weight:bold">
                                        <f:convertNumber pattern="##,###,###,###.##" minFractionDigits="2" />
                                    </h:outputText>
                                    <br></br><br></br>
                                    <h:outputText value="R$ " style="font-size:9px;" class="espacocobranca29"/>
                                    <h:outputText value="#{opcional.valorOriginalRS}" style="font-size:9px;">
                                        <f:convertNumber pattern="##,###,###,###.##" minFractionDigits="2" />
                                    </h:outputText>
                                </p:overlayPanel>
                                <br></br>
                            </h:panelGrid>
                        </p:outputPanel>
                    </p:dataScroller>
                    <br></br> <br></br>
                    <p:selectBooleanCheckbox value="#{orcamentoCursoMB.seguroSelecionado}" class="espacocobranca29">
                        <p:ajax update="tabelaAdicionarSeguro" listener="#{orcamentoCursoMB.selecionarSeguro()}"/>
                        <p:ajax update="orcamentoCurso:tabelatotal" />
                    </p:selectBooleanCheckbox>
                    <h:outputText  value="Seguro Viagem" style="font-weight:bold;font-size: 17px;color: #fff" class="espacocobranca29"/>
                    <p:accordionPanel id="tabelaAdicionarSeguro"  class="painelPacote" style="width: 100%;margin-left:0%" activeIndex="-1">
                        <p:tab  title="Adicionar">
                            <p:outputLabel value="Seguradora:" for="seguradora" class="espacocobranca11"/>
                            <p:selectOneMenu class="espacocobranca29" style="width:15%;" id="seguradora"  value="#{orcamentoCursoMB.fornecedorcidade}" 
                                             converter="FornecedorCidadeConverter" disabled="#{orcamentoCursoMB.habilitarSeguro()}">
                                <f:selectItem itemLabel="Seguradora" itemValue="0" noSelectionOption="true" /> 
                                <f:selectItems id="idseguradora" value="#{orcamentoCursoMB.listaFornecedorCidade}" var="cursoseguradora" itemLabel="#{cursoseguradora.fornecedor.nome}" itemValue="#{cursoseguradora}"/>
                                <f:attribute name="listaFornecedorCidade" value="#{orcamentoCursoMB.listaFornecedorCidade}"/>
                                <p:ajax event="change" update="planoseguro"/> 
                            </p:selectOneMenu>
                            <p:outputLabel value="Plano:" for="planoseguro" class="espacocobranca28"/>
                            <p:selectOneMenu id="planoseguro" class="espacocampos" style="width:19%;" value="#{orcamentoCursoMB.valorSeguro}" 
                                             converter="ValorSeguroConverter" disabled="#{orcamentoCursoMB.habilitarSeguro()}">
                                <f:selectItem itemLabel="Plano" itemValue="0" noSelectionOption="true"/> 
                                <f:selectItems id="idvaloresseguro" value="#{orcamentoCursoMB.fornecedorcidade.valoresseguroList}" var="cvalorseguro" itemLabel="#{cvalorseguro.plano}" itemValue="#{cvalorseguro}"/>
                                <f:attribute name="listaValorSeguro" value="#{orcamentoCursoMB.fornecedorcidade.valoresseguroList}"/>
                                <p:ajax event="change" update="cobranca" />
                            </p:selectOneMenu>
                            <p:outputLabel value="Cobrança:" for="cobranca" class="espacocobranca28"/>
                            <p:inputText id="cobranca" value="#{orcamentoCursoMB.valorSeguro.cobranca}" style="width:19%" maxlength="45" class="espacocobranca29" readonly="true" 
                                         disabled="#{orcamentoCursoMB.habilitarSeguro()}"/>

                            <br></br><br></br>
                            <p:outputLabel value="Data inicial:" for="datainicio" class="espacocobranca11"/>
                            <p:calendar id="datainicio" size="15" value="#{orcamentoCursoMB.seguroviagem.dataInicio}"  class="espacocobranca29" locale="pt"  pattern="dd/MM/yyyy" disabled="#{orcamentoCursoMB.habilitarSeguro()}">
                                <f:convertDateTime   pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo"/>
                                <p:ajax event="change" />
                                <p:ajax event="dateSelect" />
                            </p:calendar>
                            <p:outputLabel value="No. Semanas:" for="semanas" class="imgadd"/>
                            <p:inputText id="semanas" value="#{orcamentoCursoMB.seguroviagem.numeroSemanas}" style="width:7%" maxlength="45" class="loginButton2"  disabled="#{orcamentoCursoMB.habilitarSeguro()}">
                                <f:convertNumber  type="number"/>
                                <p:ajax event="blur" update="datatermino, valorseguro" listener="#{orcamentoCursoMB.calcularDataTermino()}" /> 
                                <p:ajax event="blur" listener="#{orcamentoCursoMB.calcularTotais()}" update="orcamentoCurso:tabelatotal"/>
                            </p:inputText>
                            <p:outputLabel value="Data Final:" for="datatermino" class="imgadd" />
                            <p:calendar id="datatermino" value="#{orcamentoCursoMB.seguroviagem.dataTermino}" size="15" class="loginButton2" locale="pt"  pattern="dd/MM/yyyy" disabled="#{orcamentoCursoMB.habilitarSeguro()}">
                                <f:convertDateTime   pattern="dd/MM/yyyy" timeZone="America/Sao_Paulo"/>
                                <p:ajax event="blur" update="valorseguro" listener="#{orcamentoCursoMB.calcularValorSeguroViagem()}" />
                                <p:ajax event="blur" listener="#{orcamentoCursoMB.calcularTotais()}" update="orcamentoCurso:tabelatotal"/>
                            </p:calendar>
                            <p:outputLabel value="Valor do Seguro:" for="valorseguro" class="imgadd"/>
                            <p:inputText id="valorseguro" value="#{orcamentoCursoMB.seguroviagem.valorSeguro}" style="width:11%" maxlength="45" readonly="true" class="loginButtonr" disabled="#{orcamentoCursoMB.habilitarSeguro()}">
                                <f:convertNumber pattern="##,###,###,###.##" minFractionDigits="2" />
                            </p:inputText>
                        </p:tab>
                    </p:accordionPanel>
                    <br></br> <br></br>
                    <h:outputText value="Acomodação" style="font-weight:bold;font-size: 17px;color: #fff" class="espacocobranca29"/>
                     <p:dataTable id="idtabelaAcomodacao" var="acomodacao"  value="#{orcamentoCursoMB.filtrarEscolaMB.fornecedorProdutosBean.listaAcomodacoes}" class="tabela" 
                            editable="true" editMode="cell"   style="border: none" selection="#{orcamentoCursoMB.produtosOrcamentoBean}" rowKey="#{acomodacao.idproduto}">
                         <p:column style="width:32px" >   
                             <p:selectBooleanCheckbox value="#{acomodacao.selecionado}">
                                <p:ajax listener="#{orcamentoCursoMB.calcularValorAcomodacao(acomodacao)}" update="orcamentoCurso:tabelatotal"/>
                            </p:selectBooleanCheckbox>
                        </p:column>
                        <p:column headerText="Descrição"  >
                            <h:outputText value="#{acomodacao.valorcoprodutos.coprodutos.descricao}" />
                        </p:column>
                        <p:column headerText="Valor da Acomodação" style="width:140px;text-align: right" >
                            <h:outputText value="#{acomodacao.valorcoprodutos.valororiginal}" >
                                 <f:convertNumber pattern="##,###,###,###.##" minFractionDigits="2" />
                             </h:outputText>
                        </p:column>
                        <p:column headerText="Nº de Semanas" style="width:125px;" >
                            <p:cellEditor>
                                <f:facet name="output"><h:outputText value="#{acomodacao.numeroSemanas}" /></f:facet>
                                <f:facet name="input">
                                    <p:inputText value="#{acomodacao.numeroSemanas}" style="width: 90%">
                                        <p:ajax event="blur" listener="#{orcamentoCursoMB.calcularValorAcomodacao(acomodacao)}" update="orcamentoCurso:idtabelaAcomodacao, orcamentoCurso:tabelatotal"/>
                                </p:inputText>
                            </f:facet>
                            </p:cellEditor>
                        </p:column>
                        <p:column headerText="Valor R$" style="width:90px;text-align: right" >
                            <h:outputText value="#{acomodacao.valorOriginalRS}" >
                                 <f:convertNumber pattern="##,###,###,###.##" minFractionDigits="2" />
                             </h:outputText>
                        </p:column>
                        <p:column headerText="Valor" style="width:90px;text-align: right" >
                            <h:outputText value="#{acomodacao.valorOrigianl}" >
                                <f:convertNumber pattern="##,###,###,###.##" minFractionDigits="2" />
                            </h:outputText>
                        </p:column>
                    </p:dataTable>
                    <br></br> <br></br>
                    <h:outputText value="Transfer" style="font-weight:bold;font-size: 17px;color: #fff" class="espacocobranca29"/>
                    <p:dataTable id="idtabelaTransfer" var="transfer"  value="#{orcamentoCursoMB.filtrarEscolaMB.fornecedorProdutosBean.listaTransfer}" class="tabela" 
                            editable="true" editMode="cell"   style="border: none" selection="#{orcamentoCursoMB.produtosOrcamentoBean}" rowKey="#{acomodacao.idproduto}">
                         <p:column style="width:32px" >   
                             <p:selectBooleanCheckbox value="#{transfer.selecionado}">
                                 <p:ajax listener="#{orcamentoCursoMB.calcularValorTransfer(transfer)}" update="orcamentoCurso:tabelatotal"/>
                            </p:selectBooleanCheckbox>
                        </p:column>
                        <p:column headerText="Descrição"  >
                            <h:outputText value="#{transfer.valorcoprodutos.coprodutos.descricao}" />
                        </p:column>
                        <p:column headerText="Valor do Transfer" style="width:140px;text-align: right" >
                            <h:outputText value="#{transfer.valorcoprodutos.valororiginal}" >
                                 <f:convertNumber pattern="##,###,###,###.##" minFractionDigits="2" />
                             </h:outputText>
                        </p:column>
                    </p:dataTable>
                    <br></br> <br></br>
                    <p:dataScroller id="tabelatotal" value="#" var="totais" chunkSize="10" style="background:#fff" >
                        <h:panelGrid columns="1" cellpadding="5" style="text-align: right;width:50%;margin-left: 50%"> 
                            <p:outputPanel style="text-align: right;width:100%" >
                                <h:outputText value="Total" style="font-weight:bold;font-size: 18px;color:#4DA20B" />
                                <br></br>
                                <h:outputText value="#{orcamentoCursoMB.filtrarEscolaMB.fornecedorProdutosBean.cambio.moedas.sigla}" style="font-weight:bold;font-size: 14px;" />
                                <h:outputText value="#{orcamentoCursoMB.valorTotal}" style="font-weight:bold;font-size: 15px;" class="espacocobranca29">
                                    <f:convertNumber pattern="##,###,###,###.##" minFractionDigits="2" />
                                </h:outputText>
                                <br></br>
                                <h:outputText value="R$ " style="font-weight:bold;font-size: 13px;" />
                                <h:outputText value="#{orcamentoCursoMB.valorTotalRS}" style="font-weight:bold;font-size: 13px;" >
                                    <f:convertNumber pattern="##,###,###,###.##" minFractionDigits="2" />
                                </h:outputText>
                            </p:outputPanel>
                        </h:panelGrid>
                    </p:dataScroller>
                    <br></br><br></br><br></br>
                </div>
            </h:form> 
        </ui:define>
    </ui:composition>
</html>